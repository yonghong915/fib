<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<bean id="oracle" class="com.fib.uqcp.topcheer.meta.bo.SqlConfig">
		<property name="tableColumnSql">
			<value>
			<![CDATA[ 
			  SELECT 
   TRIM(SYS_CONTEXT('USERENV','DB_NAME')),
   TRIM(SYS_CONTEXT('USERENV','CURRENT_SCHEMA')),
   TRIM(H.TABLE_NANE),
   TRIM(H.COMMENTS),
   TRIM(T.COLUMN_NANE),
   TRIM(A.COMMENTS),
   T.COLUMN_ID,
   TRIM(T.DATA_TYPE),
   NVL(B.PK,'N'),
   T.DATA_LENGTH,
   T.DATA_PRECISION,
   T.DATA_SCALE,
   TRIM(T.NULLABLE)
   
   FRON USER_TAB_COLUMNS T 
 INNER JOIN USER_TAB_COMMENTS H ON T.TABLE_NAME = H.TABLE_NAME
 INNER JOIN USER_COL_COMMENTS A ON T.TABLE_NAME = A.TABLE_NAME AND T.COLUMN_NANE = A.COLUMN_NANE
 INNER JOIN USER_TABLES M ON T.TABLE_NAME = M.TABLE_NAME
 LEFT JOIN (SELECT M.TABLE_NAME,M.COLUMN_NANE,'Y' AS PK FROM USER_CONS_COLUMNS M
    INNER JOIN USER_CONSTRAINTS N ON M.CONSTRAINT_NAME=N.CONSTRAINT_NAME
	WHERE N.CONSTRAINT_TYPE='P'
 )B
 
 ON T.COLUMN_NANE = B.COLUMN_NANE
 AND T.TABLE_NAME = B.TABLE_NAME
 ORDER BY T.TABLE_NAME,T.COLUMN_ID
			]>
		</value>
	</property>
	
	<!--视图元数据-->
	<property name="viewSql"><value><! [CDATA
SELECT TRIM(SYS_CONTEXT('USERENV','DB_NAME')),
       TRIM(SYS_CONTEXT("USERENV','CURRENT_SCHEMA')),
	   TRIM(V.VIEW_NAME),
	   TRIM(H.COMMENTS),
	   V.TEXT
	   
FROM USER_VIENS V 
INNER JOIN USER_TAB_COMMENTS H ON V.VIEW_NAME = H.TABLE_NENE
ORDER BY VIEW_NAME
]]>
</value>
		</property>


		<!--视图列数据-->
		<property name="viewColumnSql">
			<value>
				<![CDATA[
SELECT TRIM(SYS_CONTEXT('USERENV','DB_NAME')),
       TRIM(SYS_CONTEXT("USERENV','CURRENT_SCHEMA')),
	   TRIM(H.TABLE_NAME),
	   TRIM(H.COMMENTS),
	   TRIM(T.COLUMN_NAME),
	   TRIM(A.COMMENTS),
	   T.COLUMN_ID
	   
  FROM USER_TAB_COLUMNS T 
 INNER JOIN USER_TAB_COMMENTS H ON T.TABLE_NAME = H.TABLE_NAME
INNER JOIN USER_COL_COMMENTS A ON T.TABLE_NAME = A.TABLE_NAME AND T.COLUMN_NANE = A.COLUMN_NANE	   
INNER JOIN USER_VIEWS M ON T.TABLE_NAME = M.VIEW_NAME
LEFT JOIN ( SELECT M.TABLE_NAME,M.COLUMN_NAME,'Y' AS PK
          FROM USER_CONS_COLUMNS M
		  INNER JOIN USER_CONSTRAINTS N ON M.CONSTRAINT_NAME = N.CONSTRAINT_NAME
		  WHERE N.CONSTRAINT_TYPE = 'P'
       )B
	ON T.COLUMN_NAME = B.COLUMN_NAME
  AND T.TABLE_NAME = B.TABLE_NAME	
ORDER BY T.TABLE_NAME,T.COLUMN_ID
]]>
			</value>
		</property>


		<!--表元数据-->
		<property name="tableSql">
			<value>
				<![CDATA[
SELECT TRIM(SYS_CONTEXT('USERENV','DB_NAME')),
       TRIM(SYS_CONTEXT("USERENV','CURRENT_SCHEMA')),
	   TRIM(T.TABLE_NAME),
	   TRIM(SELECT COUNT(*) FROM USER_TAB_COLUMNS C WHERE T.TABLE_NAME = C.TABLE_NAME),
	   T.NUM_ROWS,
	   T.NUM_ROWS * T.AVG_ROW_LEN,
	   S.BYTES,
	   O.CREATED,
	   O.LAST_DDL_TIME,
	   (SELECT LISTAGG(P.COLUMN_NAME,',') WITHIN GROUP(ORDER BY COLUMN_POSITION) FROM USER_PART_KEY_COLUMNS P WHERE P.NAME = T.TABLE_NAME)
	   
  FROM USER_TABLES T 
 LEFT JOIN (SELECT OBJECT_NAME,TO_CHAR(MAX(CREATED),'YYYYMMDD') AS CREATED FROM USER_OBJECTS GROUP BY OBJECT_NAME) O
 ON O.OBJECT_NAME = T.TABLE_NAME
 LEFT JOIN USER_SEGMENTS S ON S.SEGMENT_TYPE='TABLE' AND S.SEGMENT_NAME = T.TABLE_NAME
]]>
			</value>
		</property>

	</bean>
</beans>