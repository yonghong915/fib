<?xml version="1.0" encoding="UTF-8" ?>
<message-bean-mapping id="BEPS_124MappingOut" source-type="message-bean" target-type="map" >
	<mapping type="value" to="serviceId">receivePaymentStatusReport</mapping>
	<mapping type="value" to="batchType">immTIDIn</mapping>
	<mapping type="value" to="communicationEventTypeId">MESSAGE_IN_COMM</mapping>
	<mapping type="value-mapping" from="MsgHeader.MesgType" to="contentMimeTypeId"></mapping><!-- 报文类型代码 例如：beps.008.001.01-->
	<mapping type="value" to="prodCatalogId">BEPS</mapping><!--接收系统号-->	
		<!--验签结果-->
	<mapping type="value-mapping" from="checkEscortFlag" to="checkEscortFlag"/> <!--核押验签结果 -->
<!-- 报文头 begin -->
 	<mapping type="value-mapping" from="MsgHeader.BeginFlag" to="BeginFlag"></mapping><!-- 开始标识 -->
	<mapping type="value-mapping" from="MsgHeader.VersionID" to="VersionID" ></mapping><!--版本 -->
	<mapping type="value-mapping" from="MsgHeader.OrigSender" to="extendMap.origSender"></mapping><!--报文发起人 -->
	<mapping type="value-mapping" from="MsgHeader.OrigSender" to="instructingParty"></mapping><!--发起参与机构-->
	<mapping type="value-mapping" from="MsgHeader.OrigSenderSID" to="extendMap.origSenderSID"></mapping><!--发送系统号 -->
	<mapping type="value-mapping" from="MsgHeader.OrigReceiver" to="extendMap.origReceiver"></mapping><!--报文接收人 -->
	<mapping type="value-mapping" from="MsgHeader.OrigReceiver" to="instructedParty"></mapping><!--接收参与机构 -->
	<mapping type="value-mapping" from="MsgHeader.OrigReceiverSID" to="extendMap.origReceiverSID"></mapping><!--接收系统号 -->
	<mapping type="value-mapping" from="MsgHeader.OrigSendDate" to="extendMap.origSendDate"></mapping><!--报文发起日期 -->
	<mapping type="value-mapping" from="MsgHeader.StructType" to="StructType"></mapping><!-- 格式类型 -->
	<mapping type="value-mapping" from="MsgHeader.MesgType" to="responseMessageTypeId"></mapping><!-- 报文类型代码 -->
	<mapping type="value-mapping" from="MsgHeader.MesgType" to="contentMimeTypeId"></mapping><!-- 报文类型代码 -->
	<mapping type="value-mapping" from="MsgHeader.MesgID" to="extendMap.mesgID"></mapping><!-- 通信级标识号 -->
	<mapping type="value-mapping" from="MsgHeader.MesgRefID" to="extendMap.mesgRefID"></mapping>
	<mapping type="value-mapping" from="MsgHeader.MesgPriority" to="MesgPriority"></mapping>
	<mapping type="value-mapping" from="MsgHeader.MesgDirection" to="MesgDirection"></mapping>
    <mapping type="value-mapping" from="MsgHeader.Reserve" to="Reserve"></mapping>
	<mapping type="value-mapping" from="MsgHeader.EndFlag" to="EndFlag"></mapping><!-- 结束标识 -->
    <!-- 报文头 end-->
	<mapping type="value" to="systemCode">BEPS</mapping><!-- 系统号 -->	 
	<mapping type="value" to="itemNumber">1</mapping><!-- 回执总笔数 -->
	<!-- 报文正文其他信息 -->
	<mapping type="value-mapping" from="BEPS_124_Out.MessageIdentification" to="responseMessageId"/><!-- 报文标识号 -->
	<mapping type="value" to="responseMessageTypeId">beps.124.001.01</mapping><!-- 报文类型号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.CreationDateTime" to="CreationDateTime"/><!-- 报文发送时间 -->
	<mapping type="value-mapping" from="BEPS_124_Out.OriginalMessageIdentification" to="messageIdentification"></mapping><!-- 原报文标识号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.OriginalMessageNameIdentification" to="messageTypeId"/><!-- 原报文类型代码 -->
	<mapping type="value-mapping" from="BEPS_124_Out.StatusIdentification" to="transactionStatusList[0].responseProcessCode"/><!-- 业务回执状态 -->
	<mapping type="value-mapping" from="BEPS_124_Out.OriginalTransactionIdentification" to="transactionStatusList[0].transactionId"/><!-- 原明细标识号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.Proprietary" to="transactionStatusList[0].rejectCode"/><!-- 业务拒绝处理码 -->
	<mapping type="value-mapping" from="BEPS_124_Out.AdditionalInformation5" to="transactionStatusList[0].rejectReason"/><!-- 业务拒绝原因 -->
	<mapping type="value-mapping" from="BEPS_124_Out.CurrencyType" to="extendMap.CurrencyType"/><!-- 币种 -->
	<mapping type="value-mapping" from="BEPS_124_Out.InterbankSettlementAmount" to="transactionStatusList[0].settlementAmount"/><!-- 原货币符号、结算金额 -->
		<mapping type="value-mapping" from="BEPS_124_Out.Proprietary2" to="transactionStatusList[0].categoryPurpose">
		target.put("categoryPurpose",currentValue);
		return currentValue;
	</mapping><!--原业务类型编码 -->
	<mapping type="value-mapping" from="BEPS_124_Out.MemberIdentification" to="extendMap.MemberIdentification"/><!-- 原付款清算行行号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.Identification" to="extendMap.Identification"/><!-- 原付款行行号-->
	<mapping type="value-mapping" from="BEPS_124_Out.Unstructured" to="extendMap.Unstructured"/><!-- 代理行手续费 -->
	<mapping type="value-mapping" from="BEPS_124_Out.MemberIdentification2" to="extendMap.MemberIdentification2"/><!-- 付款清算行行号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.Identification2" to="extendMap.Identification2"/><!-- 付款行行号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.MemberIdentification3" to="extendMap.MemberIdentification3"/><!-- 收款清算行行号 -->
	<mapping type="value-mapping" from="BEPS_124_Out.Identification3" to="extendMap.Identification3"/><!-- 收款行行号 -->

	<mapping type="script" to="transactionStatusList">
    <![CDATA[
			import java.util.Map;
			import java.util.ArrayList;
			import java.util.List;
			import java.util.HashMap;
			import com.giantstone.cnaps2.messagebean.recv.req.BEPS_124_Out;
			import com.giantstone.cnaps2.messagebean.recv.req.BEPS_124_OutCcti;
			BEPS_124_Out beps124Out = sourceBean.BEPS_124_Out;
			List transactionStatusList = (List)target.get("transactionStatusList");
			Map bean = (HashMap) transactionStatusList.get(0);
			List ccti = beps124Out.getCcti();
			for(BEPS_124_OutCcti newBean : ccti) {
				String value = newBean.getAddtlInf();
				if(value.contains("F61")) {
					//NPC处理状态
					bean.put("processStatus",value.substring(5, value.length()));
					target.put("processStatus",value.substring(5, value.length()));
				} else if(value.contains("C01")){
					//NPC轧差日期
					bean.put("nettingDate",value.substring(5, value.length()));
					target.put("nettingDate",value.substring(5, value.length()));
				} else if(value.contains("E05")){
					//NPC轧差场次
					bean.put("nettingRound",value.substring(5, value.length()));
					target.put("nettingRound",value.substring(5, value.length()));
				} else if(value.contains("C00")){
					//NPC清算日期/终态日期
					bean.put("settlementDate",value.substring(5, value.length()));
					target.put("settlementDate",value.substring(5, value.length()));
				}
			}
		   target.put("transactionStatusList",transactionStatusList);
	]]>
	</mapping><!-- 明细集合 -->

  </message-bean-mapping>
