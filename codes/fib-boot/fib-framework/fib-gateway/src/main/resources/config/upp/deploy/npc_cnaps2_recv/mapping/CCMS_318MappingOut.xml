<?xml version="1.0" encoding="UTF-8"?>
<message-bean-mapping id="CCMS_318MappingOut" source-type="message-bean" target-type="map">
	<mapping type="value" to="serviceId">processCommunicationEvent</mapping>
	<mapping type="value" to="productId">K104cm318</mapping>
	<mapping type="value" to="communicationEventTypeId">MESSAGE_IN_COMM</mapping>
	<mapping type="value-mapping" from="MsgHeader.MesgType" to="contentMimeTypeId"></mapping><!-- 报文类型代码beps.008.001.01-->
	<mapping type="value-mapping" from="MsgHeader.OrigReceiverSID" to="prodCatalogId"></mapping><!-- 报文标识号-->
	<!--查找原交流事件-->
	<mapping type="value-mapping" from="CCMS_318_Out.OriginalMessageIdentification" to="extendMap.originalMessageIdentification"></mapping><!-- 原报文标识号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.Identification3" to="extendMap.originalInstructingParty"></mapping><!-- 原发起参与机构 -->
	<mapping type="value" from="CCMS_318_Out.OriginalMessageNameIdentification" to="extendMap.originalMessageType"></mapping><!--原报报文（contentMimeTypeId） -->


	<!-- 报文头 -->
	<!--<mapping type="value-mapping" from="MsgHeader.BeginFlag" to="BeginFlag"></mapping> 开始标识 -->
	<!--<mapping type="value-mapping" from="MsgHeader.VersionID" to="VersionID"></mapping> 版本号 -->
	<mapping type="value-mapping" from="MsgHeader.OrigSender" to="extendMap.origSender"></mapping><!-- 报文发起人，14位 不足则后补空格 -->
  	<mapping type="value-mapping" from="MsgHeader.OrigSenderSID" to="extendMap.origSenderSID"></mapping><!-- 发送系统号  BEPS-->
	<mapping type="value-mapping" from="MsgHeader.OrigReceiver" to="extendMap.origReceiver"></mapping><!-- 报文接收人 -->
  	<mapping type="value-mapping" from="MsgHeader.OrigReceiverSID" to="extendMap.origReceiverSID"></mapping> <!--接收系统号 BEPS-->
	<mapping type="value-mapping" from="MsgHeader.OrigSendDate" to="extendMap.origSendDate" ></mapping><!-- 报文发起日期20100501 -->
  	<mapping type="value-mapping" from="MsgHeader.OrigSendTime" to="extendMap.origSendTime"></mapping><!-- 报文发起时间094508-->
  	<mapping type="value-mapping" from="MsgHeader.StructType" to="extendMap.structType"></mapping><!-- 报文格式 -->
	<mapping type="value-mapping" from="MsgHeader.MesgID" to="extendMap.mesgID" ></mapping><!-- 通信级标志号 -->
	<mapping type="value-mapping" from="MsgHeader.MesgRefID" to="extendMap.mesgRefID"></mapping><!--通讯级参考号-->
  	<mapping type="value-mapping" from="MsgHeader.MesgPriority" to="extendMap.mesgPriority"></mapping><!-- 报文优先级-->
	<mapping type="value-mapping" from="MsgHeader.MesgDirection" to="extendMap.mesgDirection"></mapping><!--报文传输方向 -->
    <mapping type="value-mapping" from="MsgHeader.Reserve" to="extendMap.Reserve"></mapping><!--保留域-->
	<!--<mapping type="value-mapping" from="MsgHeader.EndFlag" to="EndFlag"></mapping> 结束标识 -->

	<!-- 报文体 begin-->
	<mapping type="value-mapping" from="CCMS_318_Out.MessageIdentification" to="subject"/><!-- 报文标识号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.CreationDateTime" to="extendMap.CreationDateTime"/><!-- 报文发送时间 -->
	<mapping type="value-mapping" from="CCMS_318_Out.NumberOfTransactions" to="extendMap.NumberOfTransactions"></mapping><!-- NumberOfTransactions -->
	<mapping type="value-mapping" from="CCMS_318_Out.SettlementMethod" to="extendMap.SettlementMethod"></mapping><!-- SettlementInformation -->
	<mapping type="value-mapping" from="CCMS_318_Out.MemberIdentification" to="extendMap.MemberIdentification"/><!-- 发起直接参与机构号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.Identification" to="partyIdFrom"/><!-- 发起参与机构行号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.MemberIdentification2" to="extendMap.MemberIdentification2"/><!-- 接收直接参与机构号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.Identification2" to="partyIdTo"/><!-- 接收参与机构行号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.Identification2" to="InstructedParty"/><!-- 接收参与机构行号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.OriginalMessageIdentification" to="extendMap.originalMessageIdentification"/><!--  原报文标识号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.OriginalMessageNameIdentification" to="extendMap.originalMessageType"/><!-- 原报文类型代码 -->
	<mapping type="value-mapping" from="CCMS_318_Out.Identification3" to="extendMap.originalInstructingParty"/><!-- 原报文发起参与者 -->
	
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].OriginalTransactionIdentification" to="extendMap.transactionInfos[].originalTransactionIdentification"/><!-- 原明细标识号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].CurrencyType" to="extendMap.transactionInfos[].currencyType"></mapping><!-- 币种 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].ReturnedInterbankSettlementAmount" to="extendMap.transactionInfos[].returnedInterbankSettlementAmount"></mapping><!-- ReturnedInterbankSettlementAmount -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].MemberIdentification3" to="extendMap.transactionInfos[].originalInstructingParty"/><!-- 原发起直接参与机构 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].Identification4" to="extendMap.transactionInfos[].oldLaunchBankNo"/><!-- 原发起参与机构行 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].MemberIdentification4" to="extendMap.transactionInfos[].originalMessageType"/><!-- 原接收直接参与机构号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].Identification5" to="extendMap.transactionInfos[].oldReceiveBankNo"/><!-- 原接收参与机构行号 -->
	<mapping type="value-mapping" from="CCMS_318_Out.ccti[].Proprietary" to="extendMap.transactionInfos[].originalTransactionTypeCode"/><!-- 原业务类型 -->
	<mapping type="value-mapping" from="checkEscortFlag" to="checkEscortFlag"/> <!--核押验签结果 -->
	<manual-mapping> <![CDATA[
		import java.util.Map;
		import java.util.ArrayList;
		import java.util.List;
		import java.util.HashMap;
		import com.giantstone.cnaps2.messagebean.recv.req.CCMS_318_OutAddtlInfList;
		import com.giantstone.cnaps2.messagebean.recv.req.CCMS_318_OutCcti;

		//以下是list结构，含附加域或者tag
		List AddtlInfList = sourceBean.CCMS_318_Out.AddtlInfList;
		Map extendMap = target.get("extendMap");
		String value = "";
		for(int i=0;i<AddtlInfList.size();i++){
			CCMS_318_OutAddtlInfList addInf = AddtlInfList.get(i);
			String returnType = addInf.AddtlInf;
			if(returnType.contains("F44")&&returnType.length()>5){//退回类型
				value=returnType.substring(5);
				extendMap.put("returnType",value);
			}
			if(returnType.contains("H01")&&returnType.length()>5){//附言
				value=returnType.substring(5);
				extendMap.put("postscript",value);
			}
			//extendMap.put("returnType",value);
		}

		]]> 
	</manual-mapping>

</message-bean-mapping>
	<!-- 报文体 end-->
